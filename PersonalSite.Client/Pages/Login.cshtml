@using PersonalSite.Shared
@using PersonalSite.Shared.Authentication;
@using Microsoft.JSInterop;
@inherits BlazorLayoutComponent
@inject HttpClient Http

@page "/Login"

<div>
    <div class="form-group">
        <label for="Email">Email</label>
        <input type="text" id="Email" class="form-control" value="@user.Email" />
    </div>
    <div class="form-group">
        <label for="Password">Password</label>
        <input type="password" id="Password" class="form-control" value="@user.Password" />
    </div>
    <button type="submit" class="btn btn-primary" onclick="@LoginUser">Login</button>

    @if(result != null && !result.Success)
    {
        <div class="text-danger">@result.Message</div>
    }
</div>
@functions{

    User user;
    bool loginSuccess;
    LoginResult result;

    public async Task<LoginResult> LoginUser()
    {
        result = await Http.PostJsonAsync<LoginResult>("api/user/login", user);
        return result;
    }
}